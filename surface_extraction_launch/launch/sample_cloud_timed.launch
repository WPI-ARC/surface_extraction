<launch>
    <arg name="gdb" default="false" />
    <arg name="valgrind" default="false" />
    <arg name="cachegrind" default="false" />

    <!-- Static transform from world frame to point cloud frame -->
    <node pkg="tf" type="static_transform_publisher" name="tf_broadcaster" args="0 0 1.1  0 -0.05 1.6 /world /base_link 100">
        <remap from="cloud_pcd" to="input_cloud" />
    </node>

    <!-- Pointcloud publisher -->
    <node pkg="pcl_ros" type="pcd_to_pointcloud" name="input_publisher" args="$(find surface_extraction_launch)/data/shadwell_demo_area_binary.pcd 0.1" />

    <!-- Time publisher -->
    <node pkg="surface_extraction_launch" type="emit_current_time.py" name="time_emitter" />

    <include file="$(find surface_extraction_launch)/launch/surface_extraction.launch">
        <arg name="topic_name" value="/filter/output" />

        <arg name="gdb" value="$(arg gdb)" />
        <arg name="valgrind" value="$(arg valgrind)" />
        <arg name="cachegrind" value="$(arg cachegrind)" />
    </include>

    <node pkg="nodelet" type="nodelet" name="filter" args="load pcl/PassThrough /surface_extraction/nodelet_manager">
        <param name="filter_field_name" value="intensity" />
        <param name="filter_limit_max" value="2" />
        <remap from="~input" to="cloud_pcd" />
    </node>

</launch>
